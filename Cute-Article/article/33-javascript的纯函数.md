> [阅读原文](https://segmentfault.com/a/1190000013374467?utm_source=channel-hottest)

> 最近一直在思考如何通过文章或者培训快速提升团队的编码能力，总结下来其实技术的学习分为两类：一种是系统性的学习，比如学习一门语言，学习一个开发框架，这更需要自己从入门到进阶再到实践一步步系统性的学习，单靠几篇文章或者几次培训，效果并不明显；还有一种是技巧性的学习，比如某些编程实践、设计原则，其实并没有多么复杂，但是不知道就不会用，知道了就会有意识去用，就好比玩微信游戏跳一跳，在某些方块上停留一段时间就会获得加分，不知道的时候根本想不到，知道了以后想不用都难。于是就有了《即学即用》这个系列的文章。   

系列第一篇，就从**纯函数**开始，由于我是前端方向，所以就从JavaScript语言中的纯函数说起。  

## 什么是纯函数
> 纯函数是函数式编程中非常重要的一个概念，简单来说，就是**一个函数的返回结果只依赖于它的参数，并且在执行过程中没有副作用**，我们就把这个函数叫做纯函数。  
下面我们来划重点：  
* 函数的返回结果只依赖于它的参数   
* 函数执行过程中没有副作用  

首先来解释第一点：函数的返回结果只依赖于它的参数  
```js
const a = 1
const impure = (b)=>a + b
impure(2) // 3
```
上面代码中，`impure`函数不是一个纯函数，因为它的返回结果依赖外部变量a，因为a是有可能变化的，所以我们不能保证`impure(2)`的值永远是3。虽然`impure`函数的代码没有变化，传入的参数也没有变化，但它的返回值是不可预料的。我们再来改写一下：  
```js
const a = 1
const pure = (x, b) => x + b
pure(1,2) //3
```
现在，pure的返回结果只依赖于它的参数x和b，就是说，只要代码不变，pure(1, 2)的返回值永远是3。  

这就是纯函数的第一个条件：**函数的返回结果只依赖于它的参数**   

接下来解释第二点：**函数执行中没有副作用**   

副作用是指：**在计算结果的过程中，系统状态的一种变化，或者与外部世界进行的可观察的交互**。我们再看一个例子：  
```js
var values = { a: 1 };

function impureFunction ( items ) {
  var b = 1;

  items.a = items.a * b + 2;

  return items.a;
}

var c = impureFunction( values );
values.a // 3
```
在上面的代码中，我们改变了参数对象中的一个属性。由于我们定义的函数改变的对象在我们的函数作用域之外，导致这个函数成为“不纯”的函数。  
```js
var values = { a: 1 };

function pureFunction ( a ) {
  var b = 1;

  a = a * b + 2;

  return a;
}

var c = pureFunction( values.a );
values.a // 1
```
上面的代码，我们只计算了作用域内的局部变量，没有任何作用域外部的变量被改变，因此这个函数是“纯函数”。  

除了修改外部的变量，一个函数在执行过程中还有很多方式产生外部可观察的变化，比如说调用 `DOM API` 修改页面，或者你发送了 `Ajax` 请求，还有调用 `window.reload`刷新浏览器，甚至是 `console.log` 往控制台打印数据也是副作用。  

纯函数很严格，也就是说你几乎除了计算数据以外什么都不能干，计算的时候还不能依赖除了函数参数以外的数据。  

我们再来用JavaScript中常用的两个方法`slice`和`splice`来举一个例子：  
```js
var array1 = [0,1,2,3,4,5,6];
var array2 = [0,1,2,3,4,5,6];

var spliceArray = array1.splice(0,2);
var sliceArray = array2.slice(0,2);

console.log('array1: ' + array1);
console.log('spliceArray: ' + spliceArray);

console.log('array2: ' + array2);
console.log('sliceArray: ' + sliceArray); 
```
运行结果：  
```js
array1: 2,3,4,5,6
spliceArray: 0,1
array2: 0,1,2,3,4,5,6
sliceArray: 0,1
```
可以看到，`slice`和`splice`的作用是大致相同的，但是`splice`改变了原数组，而`slice`却没有，实际开发中，`slice`这种不改变原数组的方式更安全一些，改变原始数组，是一种副作用。   

## 非纯函数带来的副作用  

既然我们推荐纯函数，那么肯定是因为非纯函数有缺陷。我们看下面的代码：   
```js
function getName(obj){
    return obj.name;
}
function getAge(obj){
  return obj.age;
}
function sayHi(person){
  console.log('I am' + getName(person) + ',and I am' + getAge(person) + 'years old');
}

var Tom = {
  name: 'TOM',
  age: 26
};

sayHi(Tom);
```
我们说`sayHi`不熟纯函数，它依赖于`getName`、`getAge`两个函数，如果我不小心改变了其中某个函数的功能，这将使得`sayHi`这个函数出现错误。当网页变得复杂，且由多人维护的时候，bug调试会变得非常复杂。  

## 使用纯函数的优点
* 1. 可复用性

纯函数仅依赖于传入的参数，这意味着你可以随意将这个函数移植到别的代码中，只需要提供踏需要的参数即可。如果是非纯函数，有可能你需要一根香蕉，却需要将整个香蕉树搬过去。   
* 2. 可测试性

纯函数非常容易进行单元测试，因为不需要考虑上下文环境，只需要考虑输入和输出。   
* 3. 并行代码

纯函数是健壮的，改变执行次序不会对系统造成影响，因此纯函数的操作可以并行执行。   

## 总结
虽然纯函数有很多优点，但也要避免滥用的情况。函数越纯，对环境依赖越小，往往意味着要传入更多的参数。我们的最终目的是：让你的代码尽可能简单易懂和灵活。这篇文章主要介绍了JavaScript中纯函数的概念，但是在很多其他开发语言中，纯函数的概念是一样通用的，比如笔者正在自学的JAVA，欢迎大家针对各种语言中对纯函数的理解和我一起讨论。  